inMemoryVolumeEnabled: true
persistentVolume:
  enabled: true
  driver: pd.csi.storage.gke.io
  volumeHandle: projects/test-project/zones/us-central3-a/disks/test-disk

initContainers: |-
  {{- range $path, $version := index $.Values.global "hail-search" "datasetVersions" -}}
  {{ if $version }}
  {{- $localPath := $path | replace "SV" "SV_WGS" | replace "GCNV" "SV_WES" -}}
  - name: sync-annotations-{{ $path | replace "/" "-" | replace "_" "-" | lower}}
    image: busybox
    command: ['/bin/sh', '-c', 'mkdir -p {{ $.Values.environment.IN_MEMORY_DIR }}/{{ $localPath }} && cp -r {{ $.Values.environment.HAIL_SEARCH_DATA_DIR }}/{{ $localPath }}/annotations.ht {{ $.Values.environment.IN_MEMORY_DIR }}/{{ $localPath }}/annotations.ht']
    volumeMounts:
      - mountPath: {{ $.Values.environment.IN_MEMORY_DIR }}
        name: datasets
      - mountPath: {{ $.Values.environment.HAIL_SEARCH_DATA_DIR }}
        name: ssd-datasets
        readOnly: true
  {{ end -}}
  {{ end }}

global:
  hail-search:
    datasetVersions:
      GRCh38/GCNV: 2023-11-03T22-31-23.149902+00-00
      GRCh37/SNV_INDEL: 2023-11-03T22-31-23.149902+00-00
      GRCh38/SNV_INDEL: 2023-11-02T23-31-23.149902+00-00
